<!-- Overlay for visual indication (does not block clicks, only scrolling is disabled) -->
@if (showBanner()) {
<div
  class="fixed inset-0 z-40 bg-black/20 pointer-events-none"
></div>
}

<!-- Cookie Banner -->
@if (showBanner()) {
<div
  class="fixed bottom-0 left-0 right-0 z-50 bg-surface-100 dark:bg-surface-900 border-t-2 border-primary-200 dark:border-primary-700 shadow-2xl animate-slide-up"
>
  <div class="max-w-7xl mx-auto p-4 md:p-6">
    <div
      class="flex flex-col lg:flex-row items-start lg:items-center gap-4 lg:gap-6"
    >
      <!-- Icon and Content -->
      <div class="flex items-start gap-4 flex-1">
        <div class="flex-shrink-0 flex items-center justify-center">
          <span style="font-size: 56px">üç™</span>
        </div>
        <div class="flex-1 min-w-0">
          <h3
            class="text-lg md:text-xl font-bold mb-2 text-surface-900 dark:text-surface-0"
          >
            {{ "COOKIE.BANNER.TITLE" | translate }}
          </h3>
          <p
            class="text-sm md:text-base text-surface-600 dark:text-surface-400 leading-relaxed"
          >
            {{ "COOKIE.BANNER.DESCRIPTION" | translate }}
            <a
              (click)="openSettings()"
              class="text-primary font-semibold underline cursor-pointer hover:text-primary-600 dark:hover:text-primary-400 transition-colors"
            >
              {{ "COOKIE.BANNER.SETTINGS_LINK" | translate }}
            </a>
          </p>
        </div>
      </div>

      <!-- Action Buttons -->
      <div
        class="flex flex-row gap-2 sm:gap-3 w-full lg:w-auto lg:flex-shrink-0 justify-end"
      >
        <p-button
          [label]="'COOKIE.BANNER.ACCEPT_ALL' | translate"
          icon="pi pi-check"
          (onClick)="acceptAll()"
          class="flex-1 sm:flex-none animate-bounce-button"
          [style]="{ minWidth: 'auto' }"
        ></p-button>
        <p-button
          [label]="'COOKIE.BANNER.ACCEPT_NECESSARY' | translate"
          [outlined]="true"
          icon="pi pi-check-circle"
          (onClick)="acceptNecessary()"
          class="flex-1 sm:flex-none"
          [style]="{ minWidth: 'auto' }"
        ></p-button>
      </div>
    </div>
  </div>
</div>
}

<p-dialog
  [visible]="showSettings()"
  (visibleChange)="showSettings.set($event)"
  [modal]="true"
  [style]="{ width: '90vw', maxWidth: '700px' }"
  [header]="'COOKIE.SETTINGS.TITLE' | translate"
  [draggable]="false"
  [resizable]="false"
  [closable]="true"
>
  <div class="flex flex-col gap-6">
    <!-- Description -->
    <div
      class="bg-indigo-500 text-white rounded-lg p-4 border border-indigo-500 shadow-lg"
    >
      <p class="text-sm md:text-base leading-relaxed mb-0">
        <i class="pi pi-info-circle mr-2"></i>
        {{ "COOKIE.SETTINGS.DESCRIPTION" | translate }}
      </p>
    </div>

    <!-- Cookie Options -->
    <div class="flex flex-col gap-4">
      <!-- Necessary Cookies -->
      <div
        class="border border-blue-500 rounded-lg p-4 md:p-5 bg-blue-500 text-white shadow-lg transition-all hover:shadow-md"
      >
        <div class="flex items-start gap-4">
          <div
            class="flex-shrink-0 w-10 h-10 rounded-full border-2 border-white flex items-center justify-center"
          >
            <i class="pi pi-shield text-lg"></i>
          </div>
          <div class="flex-1 min-w-0">
            <div class="flex items-start justify-between gap-4 mb-2">
              <div class="flex-1">
                <h4 class="font-bold text-base md:text-lg mb-1.5">
                  {{ "COOKIE.SETTINGS.NECESSARY.TITLE" | translate }}
                </h4>
                <p class="text-sm md:text-base leading-relaxed">
                  {{ "COOKIE.SETTINGS.NECESSARY.DESCRIPTION" | translate }}
                </p>
              </div>
              <p-checkbox
                [(ngModel)]="preferences.necessary"
                [binary]="true"
                [disabled]="true"
                [inputId]="'necessary'"
                class="flex-shrink-0"
              ></p-checkbox>
            </div>
            <div class="mt-2">
              <span
                class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-white/20 border border-white/30"
              >
                <i class="pi pi-lock text-xs mr-1"></i>
                {{ "COOKIE.SETTINGS.ALWAYS_ACTIVE" | translate }}
              </span>
            </div>
          </div>
        </div>
      </div>

      <!-- Analytics Cookies -->
      <div
        class="border border-teal-500 rounded-lg p-4 md:p-5 bg-teal-500 text-white shadow-lg transition-all hover:shadow-md"
      >
        <div class="flex items-start gap-4">
          <div
            class="flex-shrink-0 w-10 h-10 rounded-full border-2 border-white flex items-center justify-center"
          >
            <i class="pi pi-chart-line text-lg"></i>
          </div>
          <div class="flex-1 min-w-0">
            <div class="flex items-start justify-between gap-4 mb-2">
              <div class="flex-1">
                <h4 class="font-bold text-base md:text-lg mb-1.5">
                  {{ "COOKIE.SETTINGS.ANALYTICS.TITLE" | translate }}
                </h4>
                <p class="text-sm md:text-base leading-relaxed">
                  {{ "COOKIE.SETTINGS.ANALYTICS.DESCRIPTION" | translate }}
                </p>
              </div>
              <p-checkbox
                [(ngModel)]="preferences.analytics"
                [binary]="true"
                [inputId]="'analytics'"
                class="flex-shrink-0"
              ></p-checkbox>
            </div>
          </div>
        </div>
      </div>

      <!-- Marketing Cookies -->
      <div
        class="border border-purple-500 rounded-lg p-4 md:p-5 bg-purple-500 text-white shadow-lg transition-all hover:shadow-md"
      >
        <div class="flex items-start gap-4">
          <div
            class="flex-shrink-0 w-10 h-10 rounded-full border-2 border-white flex items-center justify-center"
          >
            <i class="pi pi-megaphone text-lg"></i>
          </div>
          <div class="flex-1 min-w-0">
            <div class="flex items-start justify-between gap-4 mb-2">
              <div class="flex-1">
                <h4 class="font-bold text-base md:text-lg mb-1.5">
                  {{ "COOKIE.SETTINGS.MARKETING.TITLE" | translate }}
                </h4>
                <p class="text-sm md:text-base leading-relaxed">
                  {{ "COOKIE.SETTINGS.MARKETING.DESCRIPTION" | translate }}
                </p>
              </div>
              <p-checkbox
                [(ngModel)]="preferences.marketing"
                [binary]="true"
                [inputId]="'marketing'"
                class="flex-shrink-0"
              ></p-checkbox>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div
      class="flex flex-row gap-2 pt-4 border-t-2 border-gray-300 justify-end"
    >
      <p-button
        [label]="'COOKIE.SETTINGS.SAVE' | translate"
        icon="pi pi-save"
        (onClick)="savePreferences()"
      ></p-button>
      <p-button
        [label]="'COOKIE.SETTINGS.CANCEL' | translate"
        [outlined]="true"
        severity="secondary"
        icon="pi pi-times"
        (onClick)="closeSettings()"
      ></p-button>
    </div>
  </div>
</p-dialog>
